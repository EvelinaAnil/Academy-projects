<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
          integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="././fontawesome-free/css/all.min.css">
    <title>Корзина товаров ^_^</title>
    <meta name="description" content="Создание корзины покупок для сайта на JS ">
    <style>
        body{
            background-image: url("img/blue_bubbles.jpg.jpg");
        }
        h1.title_cart {
            font-size: 2rem !important;
            line-height: 1 !important;
        }
        .card {
            transition: 0.2s;
        }
        .card-deck .card-body {
            transition: 0.2s;
        }
        .card-deck .card-body:hover {
            margin-top: -10px;
        }
        .card:hover {box-shadow: none !important;}
        span#count {
            position: absolute;
            top: -10px;
            right: -15px;
        }
    </style>
</head>
<body>
<section>
    <nav class="navbar fixed-top navbar-light bg-light">
        <a class="navbar-brand" href="#">Магазин смартфонов</a>
        <form class="form-inline">
            <a class="btn btn-outline-success my-2 my-sm-0 position-relative cart_count mr-3" data-toggle="modal"
               data-target="#staticBackdrop">
               Корзина<span
                        id="count" class="badge badge-pill badge-danger"
                ></span></a>
        </form>
    </nav>
</section>

<section class="mt-5">
    <div class="container">
        <div class="row">
            <div class="col-md-12 col-md-12 mt-4"><h1 class="title_cart">Корзина товаров </h1>
                <div class="card-deck mt-4 mb-4 text-center">
                    
                        <div class="card mb-4 shadow">
                            <div class="card-header p-3">
                                <h4 class="my-0 font-weight-normal">Iphone 11 Pro</h4>
                            </div>
                            <div class="card-body">
                                <img src="img/iphone11.png.png"
                                     class="img-fluid rounded-3" alt="Cotton T-shirt">
                                <div>Цвет: Серый</div>
                                <h1 class="card-title pricing-card-title">$255</h1>
                                <button type="button" class="btn btn-block btn-primary"
                                        onclick='cartLS.add({"id":174,"name":"Iphone 11 Pro","price":255,"color":"Серый","img":".\/img/iphone11.png.png"})'><i class="fas fa-shopping-cart"></i> В корзину
                                </button>
                            </div>
                        </div>
                    
                        <div class="card mb-4 shadow">
                            <div class="card-header p-3">
                                <h4 class="my-0 font-weight-normal">Samsung Galaxy A52</h4>
                            </div>
                            <div class="card-body">
                                <img src="img/samsung_galaxy_a52.png.png"
                                     class="img-fluid rounded-3" alt="Cotton T-shirt">
                                <div>Цвет: Белый</div>
                                <h1 class="card-title pricing-card-title">$235</h1>
                                <button type="button" class="btn btn-block btn-primary"
                                        onclick='cartLS.add({"id":181,"name":"Samsung Galaxy A52","price":235,"color":"Белый","img":".\/img\/samsung_galaxy_a52.png.png"})'><i class="fas fa-shopping-cart"></i> В корзину
                                </button>
                            </div>
                        </div>
                    
                        <div class="card mb-4 shadow">
                            <div class="card-header p-3">
                                <h4 class="my-0 font-weight-normal">Iphone 13 Pro</h4>
                            </div>
                            <div class="card-body">
                                <img src="img/iphone_13_pro.png.png"
                                     class="img-fluid rounded-3" alt="Cotton T-shirt">
                                <div>Цвет: Серый</div>
                                <h1 class="card-title pricing-card-title">$365</h1>
                                <button type="button" class="btn btn-block btn-primary"
                                        onclick='cartLS.add({"id":166,"name":"Iphone 13 Pro","price":365,"color":"Серый","img":".\/img\/iphone_13_pro.png.png"})'><i class="fas fa-shopping-cart"></i> В корзину
                                </button>
                            </div>
                        </div>
                    
                        <div class="card mb-4 shadow">
                            <div class="card-header p-3">
                                <h4 class="my-0 font-weight-normal">Xiaomi Mi 9</h4>
                            </div>
                            <div class="card-body">
                                <img src="img/Xiaomi_Mi_9.pnq.png"
                                     class="img-fluid rounded-3" alt="Cotton T-shirt">
                                <div>Цвет: Черный</div>
                                <h1 class="card-title pricing-card-title">$210</h1>
                                <button type="button" class="btn btn-block btn-primary"
                                        onclick='cartLS.add({"id":134,"name":"Xiaomi Mi 9","price":210,"color":"Черный","img":".\/img/Xiaomi_Mi_9.pnq.png"})'><i class="fas fa-shopping-cart"></i> В корзину
                                </button>
                            </div>
                        </div>
                                    </div>
             </div>
        </div>
    </div>
</section>

<!-- Modal -->
<div class="modal fade" id="staticBackdrop" data-backdrop="static" data-keyboard="false" tabindex="-1"
     aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">Корзина покупок</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="block_cart">

                </div>
                <div class="h5 text-right"><strong class="total"></strong></div>
            </div>
            <div class="modal-footer">
                <div class="send_order"></div>
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Продолжить покупки</button>
            </div>
        </div>
    </div>
</div>

<!-- Optional JavaScript; choose one of the two! -->

<!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF"
        crossorigin="anonymous"></script>
<script src="https://unpkg.com/cart-localstorage@1.1.4/dist/cart-localstorage.min.js" type="text/javascript"></script>
<script>
    //var loc =  JSON.parse({"1":{"id":174,"name":"Iphone 11 Pro","price":255,"color":"\u0421\u0435\u0440\u044b\u0439","img":".\/img\/iphone11.png"},"2":{"id":181,"name":"Samsung Galaxy A52","price":235,"color":"\u0411\u0435\u043b\u044b\u0439","img":".\/img\/samsung_galaxy_a52.png"},"3":{"id":166,"name":"Iphone 13 Pro","price":365,"color":"\u0421\u0435\u0440\u044b\u0439","img":".\/img\/iphone_13_pro.png"},"4":{"id":134,"name":"Xiaomi Mi 9","price":210,"color":"\u0427\u0435\u0440\u043d\u044b\u0439","img":".\/img\/Xiaomi_Mi_9.png"}});
    function renderCart(items) {
        const $cart = document.querySelector(".cart")
        const $total = document.querySelector(".total")
        const $count = document.querySelector("#count")
        const $block_cart = document.querySelector(".block_cart")
        const $send_order = document.querySelector(".send_order")

        $block_cart.innerHTML = items.map((item) => `
            <div class="card rounded-3 mb-4">
            <div class="card-body p-4">
            <div class="row d-flex justify-content-between align-items-center">
            <div class="col-md-2 col-lg-2 col-xl-2">
            <img src="${item.img}" class="img-fluid rounded-3" alt="Cotton T-shirt">
            </div>
        <div class="col-md-3 col-lg-3 col-xl-3">
            <p class="lead fw-normal mb-2">${item.name}</p>
            <p><span class="text-muted">Цвет: </span>${item.color}
            </p>
        </div>
        <div class="col-md-3 col-lg-3 col-xl-2 d-flex justify-content-center">
            <button type="button" class="btn btn-sm btn-outline-dark"
								onClick="cartLS.quantity(${item.id},-1)">-</button>

            <div class="pl-3 pr-3">${item.quantity}</div>

                <button type="button" class="btn btn-sm btn-outline-dark"
								onClick="cartLS.quantity(${item.id},1)">+</button>
        </div>
        <div class="col-md-3 col-lg-2 col-xl-2 offset-lg-1 text-center">
            <h5 class="mt-3 mt-md-0">$${item.price * item.quantity }</h5>
        </div>
        <div class="col-md-1 col-lg-1 col-xl-1 text-end text-center">
            <a href="#!" class="btn btn-danger btn-sm" onClick="cartLS.remove(${item.id})">Удалить</a>
        </div>
    </div>
    </div>
    </div>`).join("")

        var items = cartLS.list();

        var tot = items.reduce((sum, item) => sum + item.quantity, 0);
if (cartLS.total() === 0){
    $total.innerHTML = 'В корзине нет товаров.';
    $send_order.innerHTML = '';
    $count.innerHTML = '';
}else{
    $total.innerHTML = "Товаров: "+tot+ " на сумму: $" + cartLS.total();
    $send_order.innerHTML = '<button type="button" class="btn btn-success">Оформить заказ</button>';
    $count.innerHTML = cartLS.list().length;
}

    }

    renderCart(cartLS.list())
    cartLS.onChange(renderCart)
</script>


<script type="text/javascript">
(function (d, w, c) { (w[c] = w[c] || []).push(function()
 { try { w.yaCounter975926 = new Ya.Metrika({id:975926,
  enableAll: true, webvisor:true}); } catch(e) { } }); 
  var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), 
  f = function () { n.parentNode.insertBefore(s, n); }; 
  s.type = "text/javascript"; s.async = true;
   s.src = (d.location.protocol == "https:" ? "https:" : "http:")
    + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]")
     { d.addEventListener("DOMContentLoaded", f); 
    } else { f(); } })
     (document, window, "yandex_metrika_callbacks");
     </script>
     <noscript>
        <div>
            <img src="//mc.yandex.ru/watch/975926" 
            style="position:absolute; left:-9999px;" 
            alt="" /></div></noscript>
    
</body>
</html>